/*!
 * uform
 * https://github.com/yqfang/UForm#readme
 * yqfang,qianzhixiang
 * Version: 1.0.0 - 2016-07-22T20:16:29.442Z
 * License: ISC
 */
!function(){"use strict";function e(e,t,n){angular.extend(this,n.buildDialog(e.header,e.body,e.footer)),angular.extend(this,{ok:function(){t.close("")},cancel:function(){t.dismiss("Canceled")}})}var t=angular.module("up.uform",["ng-package"]);t.config(["$provide","datepickerConfig",function(e,t){t.showWeeks=!1,e.decorator("ngModelDirective",["$delegate",function(e){var t=e[0],n=t.controller;return t.controller=["$scope","$element","$attrs","$injector",function(e,t,i,r){var l=r.get("$interpolate");i.$set("name",l(i.name||"")(e)),r.invoke(n,this,{$scope:e,$element:t,$attrs:i})}],e}]),angular.forEach({"ng-form":"ngFormDirective",form:"formDirective"},function(t){e.decorator(t,["$delegate",function(e){var t=e[0],n=t.controller;return t.controller=["$scope","$element","$attrs","$injector",function(e,t,i,r){var l=r.get("$interpolate");i.$set("name",l(i.name||i.ngForm||"")(e)),r.invoke(n,this,{$scope:e,$element:t,$attrs:i})}],e}])})}]),t.directive("compileField",["$compile","uFormUtil",function(e,t){return{restrict:"A",controller:["$scope",function(e){this.field=e.$parent.$eval("field"),this.form={}}],require:"?^uForm",controllerAs:"$proxy",scope:{},link:function(n,i,r,l){angular.extend(n.$proxy.form,l);var o=n.$parent.$eval(r.compileField)||"up-text",a=i.closest("[u-form]"),d=n.$proxy.field.name,u=a.find("[transclude-id='"+l.option.name+"."+d+"']");t.getTemplate("field").then(function(t){var r=t.replace(/tmptype/i,o);u.length?(u.html(r),e(u.contents())(n)):(i.html(r),e(i.contents())(n))})}}}]),t.directive("ufieldDisabled",["$parse",function(e){return{require:"?^uForm",restrict:"A",link:function(t,n,i,r){t.$watch(function(){var t=e(i.ufieldDisabled)(r.result);return t},function(e){n[0].disabled=e})}}}]),t.directive("ufieldHide",["$parse",function(e){return{require:"?^uForm",restrict:"A",link:function(t,n,i,r){"hide"in t.$proxy.field&&t.$watch(function(){var t=e(i.ufieldHide)(r.result);return t},function(e){n.css("display",e?"none":""),e&&delete r.result[t.$proxy.field.name]})}}}]),t.directive("uForm",function(){return{restrict:"EA",controller:["$scope","$attrs","$filter",function(e,t,n){var i=e.$parent;this.fields=i.$eval(t.fields),this.sfields=n("orderById")(this.fields,"id"),this.option=i.$eval(t.option),this.result=i.$eval(t.result)||i.$eval(t.result+"={}")}],scope:{},templateUrl:"form.html",controllerAs:"uform",require:"?^uFormGroup",link:function(e,t,n,i){e.uform.$form=e.$parent.$eval(n.name),i&&i.fields&&i.fields.push(e.uform.fields),i&&i.result&&i.result.push(e.uform.result)}}}),t.directive("uFormGroup",function(){return{controller:["$scope","$attrs",function(e,t){this.fields=e.$parent.$eval(t.fields)||e.$parent.$eval(t.fields+"=[]"),this.result=e.$parent.$eval(t.result)||e.$parent.$eval(t.result+"=[]")}],scope:{},template:"<div ng-transclude></div>",controllerAs:"uFormGroup",transclude:!0}}),t.directive("capitalize",function(){return{require:"ngModel",link:function(e,t,n,i){var r=function(e){void 0==e&&(e="");var t=e.toUpperCase();return t!==e&&(i.$setViewValue(t),i.$render()),t};i.$parsers.push(r),r("")}}}),t.directive("truncateTo",["$parse",function(e){return{require:"ngModel",restrict:"A",link:function(e,t,n,i){var r=function(e){var t=parseInt(n.truncateTo);void 0==e&&(e="");var r=e.substring(0,t);return r!==e&&(i.$setViewValue(r),i.$render()),r};i.$parsers.push(r),r("")}}}]),t.controller("commonDialogController",e),e.$inject=["data","$modalInstance","uform"],t.directive("upNormalDialogFooter",["$compile","uFormUtil",function(e,t){return{restrict:"EA",link:function(n,i,r){t.getTemplate("up-normal-dialog-footer").then(function(t){i.html(t.replace(/DIALOG_OK/g,r.ok||"确定").replace(/DIALOG_CANCEL/g,r.cancel||"取消")),e(i.contents())(n)})}}}]),angular.forEach({upText:"up-text",upDate:"up-date",upTime:"up-time",upDatetime:"up-datetime",upPassword:"up-password",upCheckbox:"up-checkbox",upRadio:"up-radio",upSubmit:"up-submit",upSelect:"up-select",upTextarea:"up-textarea"},function(e,n){t.directive(n,["$compile","uFormUtil",function(t,n){return{restrict:"EA",controller:["$scope",function(e){angular.extend(this,e.$proxy)}],controllerAs:"vm",link:function(i,r,l){n.getTemplate(e).then(function(e){r.html(e.replace(/ng-model/g,n.toAttrs(i.vm.field.extend)+"ng-model")),t(r.contents())(i)})}}}])}),t.directive("upDialog",["dialogs",function(e){return{restrict:"EA",controller:["$scope",function(t){var n=this;angular.extend(this,t.$proxy),n.header=n.field.header,n.body=n.field.body,n.footer=n.field.footer,this.open=function(t){e.create("up-normal-dialog.html",(n.field.controller||"commonDialogController")+" as vm",n,{size:n.field.size}).result.then(function(e){n.form.result[n.field.name]=e})}}],controllerAs:"vm",template:'<button class="btn btn-default" ng-click="$event.preventDefault();vm.open($event)">{{vm.field.button}}</button>',link:function(e,t,n){}}}]),t.directive("upEditor",["$compile","uFormUtil",function(e,t){return{restrict:"EA",controller:["$scope",function(e){var t=this,n={sql:"text/x-sql",javascript:"application/javascript",json:"application/json"};angular.extend(this,e.$proxy),t.field.option={};var i=n[t.field.syntax];angular.extend(this.field.option,{lineNumbers:!0,lineWrapping:!0,mode:i||"text/x-sql"})}],controllerAs:"vm",link:function(n,i,r){t.getTemplate("up-editor").then(function(r){i.html(r.replace(/ng-model/g,t.toAttrs(n.vm.field.extend)+"ng-model")),e(i.contents())(n)})}}}]),t.directive("upNormalForm",["$compile","uFormUtil",function(e,t){return{restrict:"EA",link:function(n,i,r){t.getTemplate("up-normal-form").then(function(t){i.html(t.replace(/FORM_NAME/g,r.name)),e(i.contents())(n)})}}}]),t.directive("upFormActualLayout",["uFormUtil","$compile",function(e,t){return{restrict:"EA",transclude:!0,require:"?^uForm",link:function(e,n,i,r){var l=r.option.layout;if(l){for(var o=24/l.length,a=(r.sfields.length,"</div>"),d="",u=0,m=0;m<l.length;m++){var s='<div class="col-xs-'+o+'">',c=[];if(l[m]||(l[m]=r.sfields.length/l.length),m==l.length-1){for(var p=0,f=0;f<l.length-1;f++)p+=l[f];l[m]=r.sfields.length-p}for(var v=l[m],g=0;g<v&&u<r.sfields.length;g++)c[g]='<div transclude-id="'+r.option.name+"."+r.sfields[u].name+'"></div>',u++;s+=c.join(""),s+=a,d+=s}n.html(d),t(n.contents())(e)}}}}]),t.directive("upFormLayout",function(){return{restrict:"EA",transclude:!0,templateUrl:"up-form-layout.html",link:function(e,t,n){}}}),t.provider("uform",function(){function e(e,t,n){return{header:e||"请在 field 配置 header 项",body:t||"请在 field 配置 body 项",footer:n||'<button class="btn btn-warning" type="button" ng-click="vm.cancel()">取消</button>'}}function t(e,t,n,i){function r(){return a}function l(e,t,n,i,a,m){return d[e]={type:t,id:o,label:n,style:i},angular.extend(d[e],a),u[e]=m,o++,{addField:l,end:r}}var o=1,a={option:{name:e||"",formClass:t||"form-horizontal",labelClass:n||null,inputClass:i||"col-xs-12"},fields:{},result:{}},d=a.fields,u=a.result;return{addField:l,end:r}}this.$get=function(){return{buildDialog:e,buildForm:t}}}),t.filter("orderById",function(){return function(e,t,n){var i=[];return angular.forEach(e,function(e,t){e.name=t,i.push(e)}),i.sort(function(e,n){return e[t]>n[t]?1:-1}),n&&i.reverse(),i}}),t.factory("uFormUtil",["$templateCache","$q","$http","dialogs",function(e,t,n,i){function r(e){if(!e)return"";var t="";for(var n in e){var i;i=e[n]?n+"="+e[n]:n,t+=i+" "}return t}function l(r){var l=r+".html",o=e.get(l);return o?t.when(o):n.get(l,{cache:!0}).then(function(t){return e.put(l,t.data),t.data},function(e){i.error("模板错误!","通过："+l+" 找不到模板")})}return{toAttrs:r,getTemplate:l}}]),t.directive("upBindCompile",["$compile",function(e){return{restrict:"EA",link:function(t,n,i){var r=t.$eval(i.upBindCompile);n.html(r&&r.toString()),e(n.contents())(t)}}}])}(),angular.module("up.uform").run(["$templateCache",function(e){e.put("field.html",'<div class=form-group ufield-hide={{$proxy.field.hide}} ng-class="{\'has-error\': $proxy.form.$form[$proxy.field.name].$dirty && $proxy.form.$form[$proxy.field.name].$invalid}"><label for={{$proxy.field.name}} ng-class=$proxy.form.option.labelClass class=control-label><span ng-show="$proxy.field.extend[\'ng-required\'] && $proxy.field.label">*</span> <span ng-show="$proxy.field.type!=\'up-checkbox\'">{{ $proxy.field.label }}</span></label><div ng-class="[$proxy.field.name, $proxy.form.option.inputClass]" tmptype=""></div></div>'),e.put("form.html",'<div up-form-layout=""><style type=text/css>\n\t\t.form-horizontal .control-label {\n\t\t\ttext-align: right;\n\t\t}\n\t\t.control-datepicker {\n\t\t\tpadding-left: 0;\n\t\t}\n\t\t.timepicker tr.text-center {\n\t\t\tdisplay: none;\n\t\t}\n\t</style><div ng-repeat="field in uform.sfields"><div compile-field=field.type></div></div></div>'),e.put("up-checkbox.html","<div class=checkbox><label><input type=checkbox name={{vm.field.name}} ng-model=vm.form.result[vm.field.name]> {{ vm.field.label }}</label></div>"),e.put("up-date.html",'<div><input type=text name={{vm.field.name}} class="form-control datepicker" datepicker-popup=yyyy-MM-dd ng-model=vm.form.result[vm.field.name] ng-init="vm.form.open=false" is-open=vm.form.open ng-style=vm.field.style show-button-bar=false ng-click="vm.form.open=!vm.form.open"></div>'),e.put("up-datetime.html",'<div><div class="col-xs-12 control-datepicker"><input type=text name={{vm.field.name}} class="form-control datepicker" datepicker-popup=yyyy-MM-dd ng-model=vm.form.result[vm.field.name] ng-init="vm.form.open=false" is-open=vm.form.open show-button-bar=false ng-click="vm.form.open=!vm.form.open"></div><div><div class=timepicker timepicker="" ng-model=vm.form.result[vm.field.name]></div></div></div>'),e.put("up-editor.html",'<style>\n    .CodeMirror.cm-s-default {\n        border: 1px solid #ccc;;\n        height: 100%;\n        border-radius: 4px;\n    }\n</style><section ng-style=vm.field.style><div ui-codemirror=vm.field.option style="height: 100%;" ng-model=vm.form.result[vm.field.name]></div></section>'),e.put("up-form-layout.html",'<div><div up-form-actual-layout=""></div><div ng-transclude=""></div></div>'),e.put("up-normal-dialog-footer.html",'<button class="btn btn-primary" type=button ng-click=vm.ok()>DIALOG_OK</button> <button class="btn btn-warning" type=button ng-click=vm.cancel()>DIALOG_CANCEL</button>'),e.put("up-normal-dialog.html","<div class=modal-header><h3 class=modal-title up-bind-compile=vm.header></h3></div><div class=modal-body up-bind-compile=vm.body></div><div class=modal-footer up-bind-compile=vm.footer></div>"),e.put("up-normal-form.html",'<form u-form="" novalidate="" name={{vm.option.name}} ng-class=vm.option.formClass fields=vm.fields option=vm.option result=vm.result ng-submit=vm.submit()></form>'),e.put("up-password.html","<input type=password id={{vm.field.name}} name={{vm.field.name}} ng-model=vm.form.result[vm.field.name] class=form-control ufield-disabled={{vm.field.disabled}} ng-attr-placeholder={{vm.field.placeholder}} ng-style=vm.field.style>"),e.put("up-radio.html",'<div><div class=radio-inline ng-repeat="candidate in vm.field.candidates"><label><input type=radio ng-init="vm.form.result[vm.field.name]=vm.field.candidates[0].value" ng-model=vm.form.result[vm.field.name] name={{vm.field.name}} value={{candidate.value}}>{{candidate.label}}</label></div></div>'),e.put("up-select.html",'<select ng-init="vm.form.result[vm.field.name]=vm.field.candidates[0].value" class=form-control ng-model=vm.form.result[vm.field.name] name={{vm.field.name}} ng-options="option.value as option.name for option in vm.field.candidates"></select>'),e.put("up-submit.html",'<input class="btn btn-primary" type=submit value={{vm.field.value}}>'),e.put("up-text.html","<input type=text id={{vm.field.name}} name={{vm.field.name}} ng-model=vm.form.result[vm.field.name] class=form-control ufield-disabled={{vm.field.disabled}} ng-attr-placeholder={{vm.field.placeholder}} ng-style=vm.field.style>"),e.put("up-textarea.html","<textarea id={{vm.field.name}} name={{vm.field.name}} ng-model=vm.form.result[vm.field.name] class=form-control ufield-disabled={{vm.field.disabled}} ng-attr-placeholder={{vm.field.placeholder}} ng-style=vm.field.style>\n</textarea>"),e.put("up-time.html",'<div><div class=timepicker timepicker="" ng-model=vm.form.result[vm.field.name]></div></div>')}]);
//# sourceMappingURL=uform.min.js.map
